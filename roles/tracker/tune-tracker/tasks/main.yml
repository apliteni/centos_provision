- name: Get installed tracker version
  include_tasks: "../_shared/detect-installed-tracker-version.yml"
  vars:
    force_redetect_installed_tracker_version: true

- include_tasks: 1-generate-env-file.yml

- include_tasks: 2-generate-application-config.yml

- include_tasks: 3-migrate-db.yml

- include_tasks: 4-register-license.yml

- name: Keitaro 9.14 tasks
  when: installed_tracker_version is version('9.14', '>=')
  block:
    - include_tasks: 5-set-default-language.yml

    - include_tasks: 6-set-olap-db.yml

    - include_tasks: 7-set-tracker-stability.yml

    - include_tasks: 8-setup-clickhouse.yml
      when: olap_db == 'clickhouse'
