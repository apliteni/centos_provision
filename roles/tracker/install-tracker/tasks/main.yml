- name: Get lockfile status
  stat:
    path: "{{ keitaro_app_dir }}/var/install.lock"
  register: lockfile

- name: Install keitaro
  when: not lockfile.stat.exists
  block:
    - name: Install tracker package
      include_tasks: "install-tracker-package.yml"

    - name: Execute appropriate tasks
      include_tasks: "{{ kctl_running_mode }}.yml"
      vars:
        ansible_python_interpreter: "/usr/bin/python3"
