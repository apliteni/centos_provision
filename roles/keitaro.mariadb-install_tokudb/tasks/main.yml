- name: Install TokuDB Engine
  package:
    name: MariaDB-tokudb-engine
    state: installed
    enablerepo: mariadb
  when: rhel_version == 7

- name: Install jemalloc for Centos 8
  yum:
    name: https://centos.pkgs.org/8/getpagespeed-x86_64/jemalloc-5.1.0-3.el8.remi.x86_64.rpm.html
    state: installed
  when: rhel_version == 8

- name: Create symbolic link
  file:
    src: "/usr/lib64/libjemalloc.so.2"
    dest: "/usr/lib64/libjemalloc.so"
    state: link
  when: rhel_version == 8

- name: Install TokuDB Engine Centos 8
  yum:
    name: http://archive.mariadb.org/mariadb-10.3.18/yum/centos/8/x86_64/rpms/MariaDB-tokudb-engine-10.3.18-1.el8.x86_64.rpm
    state: installed
  when: rhel_version == 8

- name: Restart MariaDB service
  service:
    name: mariadb
    state: restarted
