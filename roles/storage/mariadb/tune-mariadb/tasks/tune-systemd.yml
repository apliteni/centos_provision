- name: Make mariadb service extra configuration dir
  file:
    path: /etc/systemd/system/mariadb.service.d
    state: directory

- name: Generate systemd nginx config
  template:
    src: "systemd/keitaro-systemd-mariadb.conf.centos{{ ansible_distribution_major_version }}.j2"
    dest: /etc/systemd/system/mariadb.service.d/keitaro-systemd-mariadb.conf
  register: mariadb_systemd_config

- name: Restart MariaDB if SystemD config changed
  service:
    name: mariadb
    state: restarted
  when: mariadb_systemd_config.changed
