dependency:
  enabled: false
driver:
  name: docker
platforms:
  - name: centos-7
    # path relative to molecule scenario directory
    image: gitlab.x.apli.tech:1443/apliteni/third-party/centos-extended:stream8
    pre_build_image: true
    pull: true
    privileged: true
    tty: true
    command: ${MOLECULE_DOCKER_COMMAND:-""}
    environment:
      container: docker
    tmpfs:
      - /run
      - /tmp
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:rw
    command: /sbin/init
provisioner:
  name: ansible
  env:
    ANSIBLE_CONFIG:          ../../../ansible.cfg          # path relative to role directory
    PLAYBOOK_ROOT:           ../../../../                  # path relative to converge.yml
    ANSIBLE_ROLES_PATH:      ../../../../../roles          # path relative to molecule scenario directory
    ANSIBLE_FILTER_PLUGINS:  ../../../../../plugins/filter # path relative to molecule scenario directory
    CI:                      true
    MOLECULE_NO_LOG:         false
    PROVISION_BIN_DIRECTORY: /provision
  inventory:
    links:
      group_vars: ../../../../../roles/_common/molecule/inventory
  playbooks:
    prepare: ../../../../../roles/_common/molecule/playbooks/prepare.yml
    converge: ../../../../../roles/_common/molecule/playbooks/converge.yml
    verify: ../../../../../roles/_common/molecule/playbooks/verify.yml
  config_options:
    defaults:
      verbosity: 1
