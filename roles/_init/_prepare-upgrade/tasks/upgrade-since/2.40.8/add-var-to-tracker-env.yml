- name: Check if item is already defined
  lineinfile:
    state: absent
    path: /etc/keitaro/config/tracker.env
    regexp: '^{{ item.key }}='
  check_mode: true
  changed_when: false           # This just makes things look prettier in the logs
  register: item_definition

- name: Define item if undefined
  lineinfile:
    state: present
    path: /etc/keitaro/config/tracker.env
    line: '{{ item.key }}={{ item.value }}'
  when: item_definition.found == 0
