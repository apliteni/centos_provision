- include_tasks: facts.yml

- name: Get statistics on files to be deleted
  stat:
    path: "{{ item }}"
  with_items: "{{ files_to_be_deleted }}"
  register: files_to_be_deleted_stat

- name: Test old files do not exist
  assert:
    that: not item.stat.exists
  with_items: "{{ files_to_be_deleted_stat.results }}"

- name: Get statistics on files to be kept
  stat:
    path: "{{ item }}"
  with_items: "{{ files_to_be_kept }}"
  register: files_to_be_kept_stat

- name: Test files exist
  assert:
    that: item.stat.exists
  with_items: "{{ files_to_be_kept_stat.results }}"
