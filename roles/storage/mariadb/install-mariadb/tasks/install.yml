- name: Add MariaDB repo
  template:
    src: mariadb.repo.j2
    dest: /etc/yum.repos.d/mariadb.repo
    force: no

- name: Install packages
  package:
    name:
      - MariaDB-server
      - MariaDB-client
      - MariaDB-tokudb-engine
      - jemalloc
    state: installed
  notify:
    - restart mariadb

- name: Install PyMySQL
  pip:
    name: pymysql
    state: present

- name: Ensure service is started
  service:
    name: mariadb
    state: started
    enabled: yes

- name: Install config file for network settings
  template:
    src: etc_my.cnf.d_network.cnf.j2
    dest: /etc/my.cnf.d/network.cnf
  notify: 
    - restart mariadb
