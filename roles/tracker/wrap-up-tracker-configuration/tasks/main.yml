- name: Configure tracker
  when: (kctl_running_mode == "install")
        or (tracker_version_to_install is defined and installed_tracker_version != tracker_version_to_install)
        or ('wrap-up-tracker-configuration' in kctl_tags)
  block:
    - include_tasks: 01-generate-env-file.yml

    - include_tasks: 02-generate-application-config.yml

    - include_tasks: 03-migrate-db.yml

    - include_tasks: 04-register-license.yml

    - include_tasks: 06-set-olap-db.yml

    - include_tasks: 07-set-tracker-stability.yml

    - include_tasks: 08-setup-clickhouse.yml
      when: olap_db == 'clickhouse'

    - include_tasks: 09-migrate-clickhouse-db.yml
      when: olap_db == 'clickhouse'

    - include_tasks: 10-update-geodb.yml

    - include_tasks: 11-configure-cron.yml

    - include_tasks: 12-generate-watchlist.yml
